(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"2fba":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 q-pa-md"},[a("table-editor",{attrs:{table:{}},on:{save:e.createTable}})],1)])},n=[],r=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("f559"),a("28a5"),a("c47a")),l=a.n(r),i=a("2f62");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){l()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"CreateTable",methods:s(s({},Object(i["b"])(["executeAction","refreshTableSchema","loadModel"])),{},{createTable:function(e){var t=this;if(0!==e.ColumnModel.length){for(var a=0;a<e.ColumnModel.length;a++){var o=e.ColumnModel[a];if(o.ColumnType.indexOf(" - ")>-1){var n=o.ColumnType.split(" - ");o.ColumnType=n[0],o.DataType=n[1],o.ColumnType.startsWith("file.")&&(o.IsForeignKey=!0,o.ForeignKeyData={DataSource:"cloud_store",Namespace:"localstore",KeyName:o.ColumnName}),e.ColumnModel[a]=o}}console.log("Table data",e);var r=e.Relations;this.$q.notify("Creating table "+e.TableName),t.$q.loading.show(),t.executeAction({tableName:"world",actionName:"upload_system_schema",params:{schema_file:[{name:"empty.json",file:"data:application/json;base64,"+btoa(JSON.stringify({Tables:[{TableName:e.TableName,Columns:e.ColumnModel}],Relations:r})),type:"application/json"}]}}).then((function(a){console.log("Created table",a),t.$q.notify("Created table, updating schema"),setTimeout((function(){t.refreshTableSchema(e.TableName).then((function(){t.$q.loading.hide(),t.$q.notify("Schema refreshed"),t.$router.push("/tables")})).catch((function(e){t.$q.notify("Failed to refresh"),t.$q.loading.hide()}))}),2e3)})).catch((function(e){t.$q.notify("Failed to create "+e),t.$q.loading.hide()}))}else this.$q.notify("Please add columns")}}),data:function(){return{text:""}},mounted:function(){},watch:{}},f=u,d=a("2877"),b=Object(d["a"])(f,o,n,!1,null,null,null);t["default"]=b.exports}}]);